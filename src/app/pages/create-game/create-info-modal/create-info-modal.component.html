<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button color="dark" (click)="dismissModal('close')">
        <ion-icon name="close"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>
      <ion-icon name="information-circle-outline" color="warning"></ion-icon>
      {{ "Tasktypes.information" | translate }}
    </ion-title>

    <ion-buttons slot="end">
      <ion-button color="dark" (click)="dismissModal(null)">
        <ion-icon name="save"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <!-- (Vir. Env.): enable teacher to choose a vir. env. -->
  <ion-item *ngIf="isVirtualWorld" class="ion-no-padding">
    <h5>Choose a virtual world</h5>
    &nbsp;&nbsp;

    <select
      [(ngModel)]="virEnvType"
      interface="popover"
      [disabled]="!isSingleMode"
    >
      <option
        *ngFor="let virEnvitem of virEnvTypesList; let i = index"
        [ngValue]="virEnvitem.layerName"
      >
        {{ i + 1 }}: {{ virEnvitem.envName }}
      </option>
    </select>
  </ion-item>
  <!--  -->

  <ion-card color="warning">
    <ion-card-content>
      <ion-icon name="help-circle"></ion-icon>
      {{ "Tasktypes.informationDescription" | translate }}
    </ion-card-content>
  </ion-card>

  <h5>{{ "CreateGame.informationText" | translate }}</h5>
  <ion-textarea
    autoGrow
    placeholder="{{ 'General.pl_optional' | translate }}"
    *ngIf="task"
    [(ngModel)]="task.question.text"
  ></ion-textarea>
  <ion-text color="medium">
    <p>
      {{ "CreateGame.markdownSupported" | translate }}
      <ion-icon
        name="information-circle"
        (click)="utilService.showPopover_i18n($event, 'Popover.markdown')"
      >
      </ion-icon>
    </p>
  </ion-text>

  <h5>{{ "CreateGame.audioMessage" | translate }}</h5>

  <app-audio-recorder
    [(audioSource)]="task.question.audio"
  ></app-audio-recorder>

  <!-- set avatar initial position and direction -->
  <ion-item *ngIf="isVirtualWorld" lines="none" class="ion-no-padding">
    <h5>
      {{ "CreateGame.setAvatarPosition" | translate }} üßç‚Äç‚ôÇÔ∏è
      <ion-icon
        name="information-circle"
        (click)="
          utilService.showPopover_i18n($event, 'CreateGame.setAvatarPosition')
        "
      >
      </ion-icon>
    </h5>
    <ion-toggle
      color="danger"
      [(ngModel)]="initialAvatarPositionStatus"
      (ngModelChange)="initialAvatarPosToggleChange()"
    ></ion-toggle>
  </ion-item>
  <div *ngIf="isVirtualWorld && initialAvatarPositionStatus">
    <!-- Map view -->
    <app-map
      featureType="direction"
      [(feature)]="task.question.initialAvatarPosition"
      [isVirtualWorld]="isVirtualWorld"
      [isVRMirrored]="isVRMirrored"
      [virEnvType]="virEnvType"
    ></app-map>
  </div>

  <!-- (Vir. Env.): choose a floor -->
  <ion-item *ngIf="isVEBuilding" lines="none" class="ion-no-padding">
    <ion-label style="font-size: 18px; font-weight: 500;">{{ "CreateTasks.chooseTaskFloor" | translate }}</ion-label>

    <select
      [(ngModel)]="selectedFloor"
      (ngModelChange)="onFloorChanged()"
      interface="popover"
      [disabled]="!isSingleMode"
    >
      <!-- slice was added to exclude sixth floor -->
      <option
        *ngFor="let floor of virEnvLayers[virEnvType].floors.slice(0, -1); let i = index"
        [ngValue]="floor.tag"
      >
        {{ floor.name }}
      </option>
    </select>
  </ion-item>
  <div>
    <app-map
      [isVirtualWorld]="isVirtualWorld"
      [virEnvType]="virEnvType"
      [isVEBuilding]="isVEBuilding"
      [selectedFloor]="selectedFloor"
      [isSingleMode]="isSingleMode"
    ></app-map>
  </div>

  <h5>{{ "CreateGame.photos" | translate }}</h5>

  <app-photo-upload
    theme="warning"
    [(photo)]="task.question.photo"
  ></app-photo-upload>

  <h5>{{ "CreateGame.addSettings" | translate }}</h5>

  <ion-item detail lines="none" (click)="presentMapFeaturesModal()">
    <ion-label> {{ "General.mapfeatures" | translate }} </ion-label>
  </ion-item>
</ion-content>
